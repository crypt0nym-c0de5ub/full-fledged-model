



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Pretty print for Table & State Test
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
output["------------------------------------------------------------------"];
output["\n|On epsilon, using pre-constructed table " ++ if OpenST = 1 then "aided by State Test|" else "|" endif ++ "\n\n"];
output["------------------------------------------------------------------"];

% Eb. Step Assignment:
output [
    "Eb. Step Assign:\n" ++
    "[    uAK    ]         [    uGK    ]         [    uSR    ]            [    uST    ]  [    uMC    ]\n" ++ 
    concat([
        "Round " ++ show(r) ++ ":\n" ++
        concat([
            "[" ++ join(" ", [if fix(uSAK[r,4*i+c]) == -1 then "  " else show_int(2, fix(uSAK[r,4*i+c])) endif | i in 0..3]) ++ "] =>(AK)- " ++
            "[" ++ join(" ", [if fix(uSGK[r,4*i+c]) == -1 then "  " else show_int(2, fix(uSGK[r,4*i+c])) endif | i in 0..3]) ++ "] -(SB)=> " ++
%             "[" ++ join(" ", [if fix(uSSB[r,4*i+c]) == -1 then "  " else show_int(2, fix(uSGK[r,4*i+c])) endif | i in 0..3]) ++ "] -(SB)=> " ++
            "[" ++ join(" ", [if fix(uSSR[r,4*i+c]) == -1 then "  " else show_int(2, fix(uSSR[r,4*i+c])) endif | i in 0..3]) ++ "] =>(SR)=> " ++
            "ST[" ++ join(" ", [if fix(uST[r,4*i+c]) == -1 then "  " else show_int(2, fix(uST[r,4*i+c])) endif | i in 0..3]) ++ "]->" ++
            "[" ++ join(" ", [if fix(uSMC[r,4*i+c]) == -1 then "  " else show_int(2, fix(uSMC[r,4*i+c])) endif | i in 0..3]) ++ "] =>(MC)=> " ++ 
            "BigMC[c" ++ show(c) ++ "]=" ++ if fix(uSBigMC[r,c]) == -1 then "-1" else show_int(2, uSBigMC[r,c]) endif ++ 
            "\n"
            | c in 0..3
        ])
        | r in 0..Rb-1
    ]) ++
    "Round " ++ show(Rb) ++ ":\n" ++ 
    concat([
        "[" ++ join(" ", [if fix(uSAK[Rb,4*i+c]) == -1 then "  " else show_int(2, fix(uSAK[Rb,4*c+i])) endif | i in 0..3])  ++ "]\n"
        | c in 0..3
    ]) ++ "\n"
];

output [
  "uFlagST " ++ show(r) ++ ": " ++ show([uFlagST[r,s] | s in -1..Step]) ++ "\n"
  | r in 0..Rb-1
];   
output["\n"];
        
output [
  "uEGK " ++ show(r) ++ ": " ++ show([uEGK[r,i] | i in 0..15]) ++ "\n"
  | r in 0..Rb-1
];
output["\n"];

output [
  "uESB " ++ show(r) ++ ": " ++ show([uESB[r,i] | i in 0..15]) ++ "\n"
  | r in 0..Rb-1
];
output["\n"];

output [
  "uEMC " ++ show(r) ++ ": " ++ show([uEMC[r,i] | i in 0..15]) ++ "\n"
  | r in 0..Rb-1
];


output["\n--------------------------------------------------------------------------------------------------------------------------\n"];


% Ef. Step Assignment:
output [
    "Ef. Step Assign:\n" ++
    "  [    lST    ]  [    lSB    ]         [    lGK    ]         [    lSR    ]          [    lMC    ]\n" ++ 
    concat([
        "Round " ++ show(r) ++ ":\n" ++
        concat([
            "ST[" ++ join(" ", [if fix(lST[r,4*i+c]) == -1 then "  " else show_int(2, fix(lST[r,4*i+c])) endif | i in 0..3]) ++ "]->" ++
            "[" ++ join(" ", [if fix(lSSB[r,4*i+c]) == -1 then "  "  elseif fix(lESB[r,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSSB[r,4*i+c])) else show_int(2, fix(lSSB[r,4*i+c])) endif | i in 0..3]) ++ "] <=(SB)- " ++
            "[" ++ join(" ", [if fix(lSGK[r+1,4*i+c]) == -1 then "  " elseif fix(lEGK[r+1,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSGK[r+1,4*i+c])) else show_int(2, fix(lSGK[r+1,4*i+c])) endif | i in 0..3]) ++ "] -(AK)<= " ++
            "[" ++ join(" ", [if fix(lSSR[r,4*i+c]) == -1 then "  " elseif fix(lEGK[r+1,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSGK[r+1,4*i+c])) else show_int(2, fix(lSSR[r,4*i+c])) endif | i in 0..3]) ++ "] <=(SR)<= " ++
            "[" ++ join(" ", [if fix(lSMC[r,4*i+c]) == -1 then "  " elseif fix(lEMC[r,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSMC[r,4*i+c])) else show_int(2, fix(lSMC[r,4*i+c])) endif | i in 0..3]) ++ "] <=(MC)<= " ++
            "BigMC[c" ++ show(c) ++ "]=" ++ if fix(lSBigMC[r,c]) == -1 then "-1" else show_int(2, lSBigMC[r,c]) endif ++ 
            "\n"
            | c in 0..3
        ])
        | r in Rb+Ru+Rm+Rl..Rb+Ru+Rm+Rl+Rf-2
    ]) ++
    concat([
        "Round " ++ show(r) ++ ":\n" ++
        concat([
            "ST[" ++ join(" ", [if fix(lST[r,4*i+c]) == -1 then "  " else show_int(2, fix(lST[r,4*i+c])) endif | i in 0..3]) ++ "]->" ++
            "[" ++ join(" ", [if fix(lSSB[r,4*i+c]) == -1 then "  " elseif fix(lESB[r,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSSB[r,4*i+c])) else show_int(2, fix(lSSB[r,4*i+c])) endif | i in 0..3]) ++ "] <=(SB)- " ++
            "[" ++ join(" ", [if fix(lSGK[r+1,4*i+c]) == -1 then "  " elseif fix(lEGK[r+1,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSGK[r+1,4*i+c])) else show_int(2, fix(lSGK[r+1,4*i+c])) endif | i in 0..3]) ++ "] -(AK)<= " ++
            "[" ++ join(" ", [if fix(lSSR[r,4*i+c]) == -1 then "  " elseif fix(lEGK[r+1,4*i+c]) != -1 then "*" ++ show_int(1, fix(lSSR[r,4*i+c])) else show_int(2, fix(lSSR[r,4*i+c])) endif | i in 0..3]) ++ "] <=(SR)" ++
            "\n"
            | c in 0..3
        ])
        | r = Rb+Ru+Rm+Rl+Rf-1
    ])
];

output["\n"];
output [
  "lFlagST " ++ show(r) ++ ": " ++ show([lFlagST[r,s] | s in -1..Step]) ++ "\n"
  | r in Rb+Ru+Rm+Rl..Rb+Ru+Rm+Rl+Rf-1
];   
output["\n"];
        
output [
  "lEGK " ++ show(r) ++ ": " ++ show([lEGK[r,i] | i in 0..15]) ++ "\n"
  | r in Rb+Ru+Rm+Rl+1..Rb+Ru+Rm+Rl+Rf
];
output["\n"];

output [
  "lESB " ++ show(r) ++ ": " ++ show([lESB[r,i] | i in 0..15]) ++ "\n"
  | r in Rb+Ru+Rm+Rl..Rb+Ru+Rm+Rl+Rf-1
];
output["\n"];

output [
  "lEMC " ++ show(r) ++ ": " ++ show([lEMC[r,i] | i in 0..15]) ++ "\n"
  | r in Rb+Ru+Rm+Rl..Rb+Ru+Rm+Rl+Rf-2
];        



output["\n--------------------------------------------------------------------------------------------------------------------------\n"];
output [
        "STEP   : [" ++ join(",", [show_int(2, fix(s)) | s in 1..Step]) ++ "]\n" ++ "         ---------------------- \n" ++ 
        "flag_PQ: [" ++ join(",", [show_int(2, fix(Fg_PQ[s])) | s in 1..Step]) ++ "] (obj: 1 = pair, 2 = quartet)\n\n" ++
        "S_G_Key: [" ++ join(",", [show_int(2, fix(STTGK[s])) | s in 1..Step]) ++ "] (Guess subkey in each step)\n\n" ++  
        "S_Fr_SB: [" ++ join(",", [show_int(2, fix(SFSB[s])) | s in 1..Step]) ++ "] (Filter obtain from SBox)\n" ++  
        "S_Fr_MC: [" ++ join(",", [show_int(2, fix(SFMC[s])) | s in 1..Step]) ++ "] (Filter obtain from Mixcolumn)\n" ++  
        "S_Fr_TT: [" ++ join(",", [show_int(2, fix(SFrTT[s])) | s in 1..Step]) ++ "] (Filter obtain Total)\n\n" ++  
        "S_M._SB: [" ++ join(",", [show_int(2, fix(SMcSB[s])) | s in 1..Step]) ++ "] (Memory cost of Sbox)\n" ++ 
        "S_Mv_Mc: [" ++ join(",", [show_int(2, fix(SMvMC[s])) | s in 1..Step]) ++ "] (Memory cost of MC_value)\n" ++ 
        "S_Md_Mc: [" ++ join(",", [show_int(2, fix(SMdMC[s])) | s in 1..Step]) ++ "] (Memory cost of MC_diff)\n" ++ 
        "S_M._ep: [" ++ join(",", [show_int(2, fix(SMeTT[s])) | s in 1..Step]) ++ "] (Memory cost in each step)\n\n" ++ 
        "S_T._ep: [" ++ join(",", [show_int(2, fix(STeTT[s])) | s in 1..Step]) ++ "] (Time cost in each step)\n\n" ++
        "Tot_ep : " ++ show_int(2, Tepsilon) ++ "                     (Time complexity on epsilon of pre-build table) \n" ++ 
        "Mot_ep : " ++ show_int(2, Mepsilon) ++ "                     (Memory complexity of pre-build table) \n" 
];

output["====================================================== E N D =============================================================\n"];
















